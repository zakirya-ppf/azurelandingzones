{
    "$schema": "<relative path to createFormUI.schema.json>",
    "view": {
        "kind": "Form",
        "properties": {
            "title": "Enterprise-Scale Landing Zones",
            "steps": [
                {
                    "name": "basics",
                    "label": "Basics",
                    "elements": [
                        {
                            "name": "resourceScope",
                            "type": "Microsoft.Common.ResourceScope"
                        }
                    ]
                },
                {
                    "name": "lzGoalState",
                    "label": "Landing zone configuration",
                    "subLabel": {
                        "preValidation": "",
                        "postValidation": ""
                    },
                    "bladeTitle": "lzGs",
                    "elements": [
                        {
                            "name": "infoBox1",
                            "type": "Microsoft.Common.InfoBox",
                            "visible": true,
                            "options": {
                                "text": "You can optionally provide subscriptions for your first landing zones for both 'online' and 'corp' and assign recommended policies that will ensure workloads will be secure, monitored, and protected according to best practices.",
                                "uri": "https://docs.microsoft.com/azure/cloud-adoption-framework/ready/enterprise-scale/design-principles#policy-driven-governance",
                                "style": "Info"
                            }
                        },
                        {
                            "name": "corpText",
                            "type": "Microsoft.Common.TextBlock",
                            "visible": true,
                            "options": {
                                "text": "Select the subscriptions you want to move to corp management group.",
                                "link": {
                                    "label": "Learn more",
                                    "uri": "https://docs.microsoft.com/azure/cloud-adoption-framework/ready/enterprise-scale/design-principles#subscription-democratization"
                                }
                            }
                        },
                        {
                            "name": "esLzConnectivity",
                            "type": "Microsoft.Common.OptionsGroup",
                            "label": "Connect corp landing zones to the connectivity hub (optional)?",
                            "defaultValue": "[if(equals(steps('esConnectivityGoalState').esHub,'Yes'),'Yes (recommended)','No')]",
                            "toolTip": "If 'Yes' is selected for corp landing zones, ARM will connect the subscriptions to the hub virtual network via VNet peering.",
                            "constraints": {
                                "allowedValues": [
                                    {
                                        "label": "Yes (recommended)",
                                        "value": "Yes"
                                    },
                                    {
                                        "label": "No",
                                        "value": "No"
                                    }
                                ]
                            },
                            "visible": "[equals(steps('esConnectivityGoalState').esHub,'Yes')]"
                        },
                        {
                            "name": "lzCorpSubsApi",
                            "type": "Microsoft.Solutions.ArmApiControl",
                            "request": {
                                "method": "GET",
                                "path": "subscriptions?api-version=2020-01-01"
                            }
                        },
                        {
                            "name": "esCorpLzSub",
                            "type": "Microsoft.Common.DropDown",
                            "label": "Corp landing zone subscriptions (optional)",
                            "toolTip": "",
                            "multiselect": true,
                            "selectAll": true,
                            "filter": true,
                            "filterPlaceholder": "Filter items ...",
                            "multiLine": true,
                            "visible": "[or(equals(steps('esConnectivityGoalState').esHub,'No'),equals(steps('lzGoalState').esLzConnectivity,'No'))]",
                            "constraints": {
                                "allowedValues": "[map(steps('lzGoalState').lzCorpSubsApi.value,(sub) => parse(concat('{\"label\":\"',sub.displayName,'\",\"description\":\"',sub.subscriptionId,'\",\"value\":\"',toLower(sub.subscriptionId),'\"}')))]",
                                "required": false
                            }
                        },
                        {
                            "name": "lzConnectedSubs",
                            "type": "Microsoft.Common.EditableGrid",
                            "ariaLabel": "Add existing subscriptions into the management group landing zone and provide address space for virtual network peering",
                            "label": "Corp connected landing zone subscriptions (optional)",
                            "visible": "[equals(steps('lzGoalState').esLzConnectivity,'Yes')]",
                            "constraints": {
                                "width": "Full",
                                "rows": {
                                    "count": {
                                        "min": 1,
                                        "max": 10
                                    }
                                },
                                "columns": [
                                    {
                                        "id": "subs",
                                        "header": "Subscription",
                                        "width": "1fr",
                                        "element": {
                                            "name": "esLzConnectedSub",
                                            "type": "Microsoft.Common.DropDown",
                                            "label": "Landing zone subscription",
                                            "toolTip": "",
                                            "multiselect": false,
                                            "selectAll": false,
                                            "filter": true,
                                            "filterPlaceholder": "Filter items ...",
                                            "multiLine": false,
                                            "constraints": {
                                                "allowedValues": "[map(steps('lzGoalState').lzSubsApi.value,(sub) => parse(concat('{\"label\":\"',sub.displayName,'\",\"description\":\"',sub.subscriptionId,'\",\"value\":\"',toLower(sub.subscriptionId),'\"}')))]",
                                                "required": false
                                            }
                                        }
                                    },
                                    {
                                        "id": "addresses",
                                        "header": "Virtual Network Address space",
                                        "width": "1fr",
                                        "element": {
                                            "type": "Microsoft.Common.TextBox",
                                            "placeholder": "Ensure there are no overlapping IP addresses!",
                                            "constraints": {
                                                "required": true,
                                                "validations": [
                                                    {
                                                        "message": "Only alphanumeric characters are allowed, and the value must be 1-30 characters long."
                                                    }
                                                ]
                                            }
                                        }
                                    }
                                ]
                            }
                        },
                        {
                            "name": "lzSubsApi",
                            "type": "Microsoft.Solutions.ArmApiControl",
                            "request": {
                                "method": "GET",
                                "path": "subscriptions?api-version=2020-01-01"
                            }
                        },
                        {
                            "name": "onlineText",
                            "type": "Microsoft.Common.TextBlock",
                            "visible": true,
                            "options": {
                                "text": "Select the subscriptions you want to move to online management group.",
                                "link": {
                                    "label": "Learn more",
                                    "uri": "https://docs.microsoft.com/azure/cloud-adoption-framework/ready/enterprise-scale/design-principles#subscription-democratization"
                                }
                            }
                        },
                        {
                            "name": "lzOnlineSubsApi",
                            "type": "Microsoft.Solutions.ArmApiControl",
                            "request": {
                                "method": "GET",
                                "path": "subscriptions?api-version=2020-01-01"
                            }
                        },
                        {
                            "name": "esOnlineLzSub",
                            "type": "Microsoft.Common.DropDown",
                            "label": "Online landing zone subscriptions (optional)",
                            "toolTip": "",
                            "multiselect": true,
                            "selectAll": true,
                            "filter": true,
                            "filterPlaceholder": "Filter items ...",
                            "multiLine": true,
                            "visible": true,
                            "constraints": {
                                "allowedValues": "[map(steps('lzGoalState').lzOnlineSubsApi.value,(sub) => parse(concat('{\"label\":\"',sub.displayName,'\",\"description\":\"',sub.subscriptionId,'\",\"value\":\"',toLower(sub.subscriptionId),'\"}')))]",
                                "required": false
                            }
                        },
                        {
                            "name": "azMonText",
                            "type": "Microsoft.Common.TextBlock",
                            "visible": true,
                            "options": {
                                "text": "Select which of the the recommended policies you will assign to your landing zones.",
                                "link": {
                                    "label": "Learn more",
                                    "uri": "https://docs.microsoft.com/en-us/azure/cloud-adoption-framework/ready/enterprise-scale/design-principles#policy-driven-governance"
                                }
                            }
                        }



                    ]
                }
            ]
        },
        "outputs": {
            "parameters": {
                "subnetMaskForGw": "[steps('esConnectivityGoalState').esAddressVpnOrEr]"
            },
            "kind": "Tenant",
            "location": "[steps('basics').resourceScope.location.name]"
        }
    }
}